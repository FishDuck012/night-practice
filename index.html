<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>thatskypiano 0.1</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --bg-top: #0f1c2e;
  --bg-bottom: #1a2740;
  --grid-bg: rgba(255,255,255,0.05);
  --grid-border: rgba(255,255,255,0.15);
  --grid-active: rgba(180,220,255,0.8);
}

body {
  margin: 0;
  background: linear-gradient(to bottom, var(--bg-top), var(--bg-bottom));
  font-family: sans-serif;
  color: white;
  overflow-x: hidden;
}

#app {
  max-width: 700px;
  margin: auto;
  padding: 20px;
  text-align: center;
}

h1 {
  font-weight: 300;
  letter-spacing: 2px;
  opacity: 0.8;
}

textarea {
  width: 100%;
  height: 100px;
  margin: 20px 0;
  border-radius: 10px;
  padding: 10px;
  background: rgba(255,255,255,0.05);
  color: white;
  border: none;
  outline: none;
}

button {
  padding: 8px 16px;
  margin: 5px;
  border-radius: 20px;
  border: none;
  background: rgba(255,255,255,0.1);
  color: white;
  cursor: pointer;
}

.grid {
  display: grid;
  grid-template-columns: repeat(5, 60px);
  gap: 10px;
  justify-content: center;
}

.cell {
  width: 60px;
  height: 60px;
  border-radius: 12px;
  background: var(--grid-bg);
  border: 1px solid var(--grid-border);
  transition: 0.3s;
}

.cell.active {
  background: var(--grid-active);
  box-shadow: 0 0 10px rgba(180,220,255,0.5);
}

#output {
  display: flex;
  flex-direction: column;
  gap: 60px;
  padding-bottom: 200px;
}

/* ËßíËâ≤ÂçÄÂüü */
#characters {
  position: fixed;
  bottom: 20px;
  left: 0;
  right: 0;
  text-align: center;
  opacity: 0.6;
  font-size: 24px;
}

/* Ê≤âÊµ∏Ê®°Âºè */
body.immersive #controls,
body.immersive textarea,
body.immersive h1 {
  display: none;
}
</style>
</head>

<body>

<div id="app">
  <h1>thatskypiano</h1>

  <div id="controls">
    <textarea id="input" placeholder="5 6 8&#10;15"></textarea>
    <br>
    <button onclick="generate()">Generate</button>
    <button onclick="toggleImmersive()">Immersive</button>
    <button onclick="togglePlay()">Play</button>
  </div>

  <div id="output"></div>
</div>

<div id="characters">
  ü¶Ü ‚ö´‚ûï‚ö™
</div>

<script>
let playing = false;
let animationId = null;

function generate() {
  const input = document.getElementById("input").value.trim();
  const output = document.getElementById("output");
  output.innerHTML = "";

  if (!input) return;

  const lines = input.split(/\r?\n/);

  lines.forEach(line => {
    if (!line.trim()) return;

    const numbers = line.trim().split(/\s+/);
    const grid = document.createElement("div");
    grid.className = "grid";

    for (let i = 1; i <= 15; i++) {
      const cell = document.createElement("div");
      cell.className = "cell";

      if (numbers.includes(i.toString())) {
        cell.classList.add("active");
      }

      grid.appendChild(cell);
    }

    output.appendChild(grid);
  });
}

function toggleImmersive() {
  document.body.classList.toggle("immersive");
  window.scrollTo({ top: 0 });
}

function togglePlay() {
  if (playing) {
    stopScroll();
  } else {
    startScroll();
  }
}

function startScroll() {
  if (!document.body.classList.contains("immersive")) return;

  playing = true;

  function scrollLoop() {
    if (!playing) return;

    window.scrollBy(0, 1);

    if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight) {
      stopScroll();
      return;
    }

    animationId = requestAnimationFrame(scrollLoop);
  }

  scrollLoop();
}

function stopScroll() {
  playing = false;
  cancelAnimationFrame(animationId);
}

document.body.addEventListener("click", function() {
  if (playing) stopScroll();
});
</script>

</body>
</html>
